<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Kbank â€“ ë°ëª¨</title>
  <meta name="theme-color" content="#0c3bd9" />
  <!-- manifest ê²½ë¡œë¥¼ ëŸ°íƒ€ì„ì— ì•ˆì „í•˜ê²Œ ì„¸íŒ…í•  ê²ƒì´ë¯€ë¡œ ì¼ë‹¨ ë¹ˆ ë§í¬ë¥¼ ë‘¡ë‹ˆë‹¤ -->
  <link id="manifestLink" rel="manifest" href="">
  <style>
    :root{ --kb-blue:#0c3bd9; --kb-card:#ffffff; --kb-text:#0f172a; }
    *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
    html,body{ margin:0;height:100%; color:var(--kb-text);background:#f6f7fb;
      font-family:'Noto Sans KR','Apple SD Gothic Neo',-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;
      font-variant-numeric:tabular-nums; font-feature-settings:"tnum" 1; font-synthesis:none; -webkit-text-size-adjust:100%; text-rendering:optimizeLegibility;}
    .view{position:fixed;inset:0;overflow:auto;background:var(--kb-card);transition:transform .35s ease}
    #home{transform:translateX(0)} #tx{transform:translateX(100%)} #tx.active{transform:translateX(0)} #home.hidden{transform:translateX(-100%)}
    .appbar{position:sticky;top:0;z-index:10;background:var(--kb-card);display:flex;align-items:center;justify-content:center;height:56px;border-bottom:1px solid #edf0f4}
    .appbar .back{position:absolute;left:8px;background:none;border:0;font-size:22px;height:56px;width:48px}
    .appbar h1{font-size:18px;margin:0}
    .wrap{padding:14px 14px 92px}
    .banner{background:#e9f0ff;border:1px solid #dbe6ff;color:#1e3a8a;border-radius:14px;padding:14px;display:flex;align-items:center;gap:10px}
    .section-title{font-weight:800;margin:16px 4px 8px}
    .card{background:var(--kb-card);border-radius:16px;box-shadow:0 1px 6px rgba(0,0,0,.06);padding:16px}
    #acctArea{display:block;border:1px solid #eff3fb;border-radius:14px;padding:16px;cursor:pointer}
    #acctArea:active{transform:scale(.995)}
    .acct-num{color:#64748b;margin:8px 0 12px}
    .balance{font-size:30px;font-weight:900;letter-spacing:-.5px}
    .btns{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:14px}
    .btn{height:48px;border-radius:12px;border:0;font-weight:800}
    .btn.gray{background:#eef1f7;color:#111} .btn.blue{background:var(--kb-blue);color:#fff}
    .quick{display:flex;gap:18px;justify-content:space-between;margin-top:14px}
    .qitem{display:flex;flex-direction:column;align-items:center;gap:8px;color:#374151;font-size:12px}
    .qicon{width:48px;height:48px;border-radius:12px;background:#f0f3fb;display:flex;align-items:center;justify-content:center;font-size:20px}
    .tabs{position:fixed;left:0;right:0;bottom:0;background:var(--kb-card);border-top:1px solid #edf0f4;display:flex;justify-content:space-around;padding:8px 6px env(safe-area-inset-bottom)}
    .tab{display:flex;flex-direction:column;align-items:center;font-size:11px;color:#6b7280;gap:4px} .tab.active{color:var(--kb-blue)}
    .header-box{padding:12px 16px 8px;border-bottom:1px solid #edf0f4}
    .acc-title{font-size:22px;font-weight:900;margin:6px 0 2px} .acc-num{font-size:14px;color:#64748b}
    .row{display:flex;align-items:center;gap:12px;margin:14px 0 6px} .row .btn{flex:1}
    .chips{display:flex;gap:10px;align-items:center}
    .chip{font-size:12px;color:#475569;border:1px solid #e5e7eb;border-radius:999px;padding:6px 10px;background:#fff}
    .tx-list{margin-top:8px} .tx-item{padding:14px 16px;border-bottom:1px solid #f0f2f7;background:#fff}
    .tx-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;color:#9ca3af;font-size:12px}
    .tx-row{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:4px;gap:12px}
    .tx-name{font-weight:700;word-break:keep-all;line-height:1.4}
    .tx-amt{font-family:'Noto Sans KR','Apple SD Gothic Neo',-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;font-variant-numeric:tabular-nums;font-feature-settings:"tnum" 1;font-synthesis:none;font-size:17px;font-weight:500;line-height:1.4;text-align:right;letter-spacing:0}
    .deposit{color:#2563eb} .withdraw{color:#d32f2f}
    .tx-bal{font-family:'Noto Sans KR','Apple SD Gothic Neo',-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;font-variant-numeric:tabular-nums;font-feature-settings:"tnum" 1;font-synthesis:none;color:#94a3b8;font-size:12px;text-align:right}
    .opt{padding:12px;border:1px solid #e5e7eb;border-radius:12px;background:#fff;text-align:center;cursor:pointer;transition:border-color .15s,box-shadow .15s,color .15s}
    .opt.selected{border-color:var(--kb-blue);box-shadow:0 0 0 3px rgba(12,59,217,.12);color:var(--kb-blue);font-weight:800}
    #installBtn{position:fixed;right:16px;bottom:86px;z-index:50;height:44px;padding:0 14px;border-radius:12px;border:0;background:var(--kb-blue);color:#fff;font-weight:900;display:none;box-shadow:0 8px 20px rgba(12,59,217,.25)}
  </style>
</head>
<body>
  <!-- ===== HOME ===== -->
  <section id="home" class="view">
    <div class="wrap">
      <div class="banner">í•œêµ­íˆ¬ìì¦ê¶Œ Â· ì§€ê¸ˆ êµ­ë‚´ ìš°ëŸ‰ì£¼ 2ì£¼ ë¿Œë¦¬ëŠ” ì¤‘!</div>
      <h3 class="section-title">Kbank</h3>
      <div class="card">
        <div id="acctArea" aria-label="ê³„ì¢Œ ìƒì„¸ ë³´ê¸°">
          <div class="acc-label" style="color:#64748b;margin-bottom:6px">MY ì…ì¶œê¸ˆí†µì¥ 100-116-054706</div>
          <div class="balance">20,300ì›</div>
        </div>
        <div class="btns">
          <button class="btn gray" id="btnGet">ê°€ì ¸ì˜¤ê¸°</button>
          <button class="btn blue" id="btnTransfer">ì´ì²´í•˜ê¸°</button>
        </div>
        <div class="quick">
          <div class="qitem"><div class="qicon">ğŸ’³</div><div>ì²´í¬ì¹´ë“œ</div></div>
          <div class="qitem"><div class="qicon">âš¡</div><div>ìë™ì¶©ì „</div></div>
          <div class="qitem"><div class="qicon">ğŸº</div><div>í”ŒëŸ¬ìŠ¤ë°•ìŠ¤</div></div>
          <div class="qitem"><div class="qicon">â­</div><div>ì…ì¶œê¸ˆë¦¬ì›Œë“œ</div></div>
        </div>
      </div>
    </div>
    <nav class="tabs">
      <div class="tab active">í™ˆ</div><div class="tab">ë°œê²¬</div><div class="tab">í˜œíƒ</div><div class="tab">íˆ¬ì</div><div class="tab">ì „ì²´</div>
    </nav>
  </section>

  <!-- ===== TX ===== -->
  <section id="tx" class="view">
    <div class="appbar"><button class="back" onclick="goHome()">â€¹</button><h1>ì…ì¶œê¸ˆí†µì¥</h1></div>
    <div class="header-box">
      <div class="acc-title">MY ì…ì¶œê¸ˆí†µì¥</div>
      <div class="acc-num">100-116-054706</div>
      <div class="row"><button class="btn gray">ê°€ì ¸ì˜¤ê¸°</button><button class="btn blue">ì´ì²´í•˜ê¸°</button></div>
      <div class="chips"><button id="openFilter" class="chip">3ê°œì›”Â·ì „ì²´Â·ìµœì‹ ìˆœ âŒ„</button></div>
    </div>
    <div id="txList" class="tx-list"></div>
  </section>

  <!-- ì„¤ì¹˜ ë²„íŠ¼ -->
  <button id="installBtn" aria-label="ì•± ì„¤ì¹˜">ì•± ì„¤ì¹˜</button>

  <!-- ===== Filter Sheet ===== -->
  <div id="mask" class="mask" style="position:fixed;inset:0;background:rgba(0,0,0,.35);opacity:0;pointer-events:none;transition:.2s"></div>
  <div id="sheet" class="sheet" role="dialog" aria-modal="true" style="position:fixed;left:0;right:0;bottom:-100%;background:#fff;border-top-left-radius:20px;border-top-right-radius:20px;box-shadow:0 -10px 30px rgba(0,0,0,.2);transition:bottom .25s ease;z-index:30">
    <div class="sheet-head" style="padding:16px;border-bottom:1px solid #edf0f4;font-weight:800">ì¡°íšŒ ì¡°ê±´</div>
    <div class="sheet-body" style="padding:14px 16px 22px">
      <div style="font-weight:800;margin:6px 0 8px">ê¸°ê°„</div>
      <div class="grid-4" id="periodBtns" style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px">
        <button class="opt" data-period="1m">1ê°œì›”</button>
        <button class="opt selected" data-period="3m">3ê°œì›”</button>
        <button class="opt" data-period="6m">6ê°œì›”</button>
        <button class="opt" data-period="1y">1ë…„</button>
      </div>
      <div style="font-weight:800;margin:16px 0 8px">ìœ í˜•</div>
      <div class="grid-3" id="typeBtns" style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px">
        <button class="opt selected" data-type="all">ì „ì²´</button>
        <button class="opt" data-type="withdraw">ì¶œê¸ˆë§Œ</button>
        <button class="opt" data-type="deposit">ì…ê¸ˆë§Œ</button>
      </div>
      <div style="font-weight:800;margin:16px 0 8px">ìˆœì„œ</div>
      <div class="grid-2" id="sortBtns" style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px">
        <button class="opt selected" data-sort="latest">ìµœì‹ ìˆœ</button>
        <button class="opt" data-sort="oldest">ê³¼ê±°ìˆœ</button>
      </div>
      <div style="font-weight:800;margin:16px 0 8px">ê¸ˆì•¡</div>
      <div class="range" style="display:flex;gap:10px">
        <input id="minAmt" placeholder="ìµœì†Œ" inputmode="numeric" style="flex:1;height:44px;border:1px solid #e5e7eb;border-radius:12px;padding:0 12px">
        <input id="maxAmt" placeholder="ìµœëŒ€" inputmode="numeric" style="flex:1;height:44px;border:1px solid #e5e7eb;border-radius:12px;padding:0 12px">
      </div>
      <button id="applyFilter" class="confirm" style="margin-top:10px;width:100%;height:52px;border:0;border-radius:14px;background:#0c3bd9;color:#fff;font-weight:900">í™•ì¸</button>
    </div>
  </div>

  <script>
    /* ===== í™”ë©´ ì „í™˜ ===== */
    const home=document.getElementById('home'), tx=document.getElementById('tx'), acctArea=document.getElementById('acctArea'), transferBtn=document.getElementById('btnTransfer');
    acctArea.addEventListener('click',()=>{ home.classList.add('hidden'); tx.classList.add('active'); });
    function goHome(){ tx.classList.remove('active'); home.classList.remove('hidden'); }
    transferBtn.addEventListener('click',()=>alert('ë°ëª¨: ì´ì²´ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.'));

    /* ===== ê±°ë˜ ë°ì´í„° ===== */
    const data=[ /* (êµìˆ˜ë‹˜ ìµœì‹  ë°°ì—´ ê·¸ëŒ€ë¡œ) */ 
      {date:'2025-10-24', time:'14:00', name:'CDí˜„ê¸ˆì§€ê¸‰', type:'withdraw', amount:100000, balance:20300},
      {date:'2025-10-24', time:'07:47', name:'ì´í¬ì§„', type:'deposit', amount:100000, balance:120300},
      {date:'2025-10-20', time:'09:12', name:'ì§€ì—ìŠ¤25 ê°€ì•¼ëŒ€í•™êµ', type:'withdraw', amount:100000, balance:20300},
      {date:'2025-10-20', time:'08:37', name:'ì´í¬ì§„', type:'deposit', amount:100000, balance:120300},
      {date:'2025-10-06', time:'10:27', name:'ì´í¬ì§„', type:'deposit', amount:300000, balance:320300},
      {date:'2025-10-06', time:'10:35', name:'CDí˜„ê¸ˆì§€ê¸‰', type:'withdraw', amount:300000, balance:20300},
      {date:'2025-09-27', time:'05:51', name:'ì´ì', type:'deposit', amount:0, balance:20300},
      {date:'2025-09-23', time:'08:42', name:'ì´í¬ì§„', type:'deposit', amount:100000, balance:120300},
      {date:'2025-09-23', time:'11:32', name:'CDí˜„ê¸ˆì§€ê¸‰', type:'withdraw', amount:100000, balance:20300},
      {date:'2025-09-14', time:'11:32', name:'ì§€ì—ìŠ¤25 ê°€ì•¼ëŒ€í•™êµ', type:'withdraw', amount:50000, balance:20300},
      {date:'2025-09-14', time:'09:50', name:'ì´í¬ì§„', type:'deposit', amount:50000, balance:70300},
      {date:'2025-08-20', time:'08:39', name:'ì´í¬ì§„', type:'deposit', amount:100000, balance:120300},
      {date:'2025-08-20', time:'10:53', name:'CDí˜„ê¸ˆì§€ê¸‰', type:'withdraw', amount:100000, balance:20300},
      {date:'2025-08-13', time:'08:39', name:'ì´í¬ì§„', type:'deposit', amount:300000, balance:320300},
      {date:'2025-08-13', time:'14:31', name:'ì„ìƒìš´ë™ì¬í™œí•™íšŒ', type:'withdraw', amount:300000, balance:20300},
      {date:'2025-07-30', time:'08:39', name:'ì´í¬ì§„', type:'deposit', amount:50000, balance:70300},
      {date:'2025-07-30', time:'11:53', name:'ì§€ì—ìŠ¤25 ê°€ì•¼ëŒ€í•™êµ', type:'withdraw', amount:50000, balance:20300},
      {date:'2025-07-28', time:'08:03', name:'ì´í¬ì§„', type:'deposit', amount:160000, balance:180300},
      {date:'2025-07-28', time:'13:21', name:'ì¡°ì„±í•™', type:'withdraw', amount:100000, balance:80300},
      {date:'2025-07-28', time:'13:23', name:'ë°•ê¸°ì¤€', type:'withdraw', amount:50000, balance:30300},
      {date:'2025-07-29', time:'09:48', name:'ì§€ì—ìŠ¤25 ê°€ì•¼ëŒ€í•™êµ', type:'withdraw', amount:10000, balance:20300},
      {date:'2025-07-26', time:'12:46', name:'ì§€ì—ìŠ¤25 ì‘ì²œë‹¬ë¹›ì ', type:'withdraw', amount:9700, balance:20300},
      {date:'2025-07-26', time:'12:32', name:'ì´í¬ì§„', type:'deposit', amount:20000, balance:30000},
      {date:'2025-07-11', time:'16:05', name:'ì´í¬ì§„', type:'deposit', amount:300000, balance:310000},
      {date:'2025-07-11', time:'17:15', name:'ì •ë‘ìˆœ', type:'withdraw', amount:300000, balance:10000},
      {date:'2025-06-03', time:'11:00', name:'ì´í¬ì§„', type:'deposit', amount:250000, balance:260000},
      {date:'2025-06-04', time:'12:05', name:'ì¡°ì„±í•™', type:'withdraw', amount:100000, balance:160000},
      {date:'2025-06-04', time:'12:11', name:'ìµœì˜ì€', type:'withdraw', amount:100000, balance:60000},
      {date:'2025-06-06', time:'10:24', name:'ì”¨ìœ (CU) ëª…ì¥ìƒˆì‹¹ì ', type:'withdraw', amount:50000, balance:10000},
      {date:'2025-06-01', time:'12:01', name:'ì´í¬ì§„', type:'deposit', amount:10000, balance:30000},
      {date:'2025-06-01', time:'11:43', name:'ì´í¬ì§„', type:'deposit', amount:20000, balance:20000},
      {date:'2025-06-01', time:'12:04', name:'ë¥˜ì¢…í˜¸', type:'withdraw', amount:10000, balance:20000},
      {date:'2025-06-01', time:'12:17', name:'ì„œì˜ì£¼(ì°©í•œì–´ë¬µê°€ê²Œ', type:'withdraw', amount:10000, balance:10000},
      {date:'2025-05-13', time:'08:34', name:'ì´í¬ì§„', type:'deposit', amount:50000, balance:50000},
      {date:'2025-05-13', time:'09:08', name:'ì§€ì—ìŠ¤25 ê°€ì•¼ëŒ€í•™êµ', type:'withdraw', amount:50000, balance:0},
      {date:'2025-02-19', time:'16:00', name:'ì´í¬ì§„', type:'deposit', amount:100000, balance:100000},
      {date:'2025-02-19', time:'16:22', name:'CDí˜„ê¸ˆì§€ê¸‰', type:'withdraw', amount:100000, balance:0},
      {date:'2025-02-05', time:'21:32', name:'ì´í¬ì§„', type:'deposit', amount:32000, balance:32000},
      {date:'2025-02-05', time:'21:34', name:'OPENAI*CHATGPT', type:'withdraw', amount:32000, balance:0}
    ];
    let state={period:'3m',type:'all',sort:'latest',min:null,max:null};
    const txList=document.getElementById('txList');
    const fmtKR=n=>Number(n).toLocaleString('ko-KR');
    function withinPeriod(d,p){ const end=new Date('2025-11-08T23:59:59'); const start=new Date(end);
      if(p==='1m')start.setMonth(end.getMonth()-1); if(p==='3m')start.setMonth(end.getMonth()-3);
      if(p==='6m')start.setMonth(end.getMonth()-6); if(p==='1y')start.setFullYear(end.getFullYear()-1);
      const dt=new Date(d.date+'T'+d.time); return dt>=start&&dt<=end; }
    function render(){
      let items=data.filter(d=>withinPeriod(d,state.period));
      if(state.type!=='all')items=items.filter(d=>d.type===state.type);
      if(state.min)items=items.filter(d=>Math.abs(d.amount)>=Number(state.min));
      if(state.max)items=items.filter(d=>Math.abs(d.amount)<=Number(state.max));
      items.sort((a,b)=> state.sort==='latest'
        ? new Date(b.date+'T'+b.time)-new Date(a.date+'T'+a.time)
        : new Date(a.date+'T'+a.time)-new Date(b.date+'T'+b.time));
      txList.innerHTML=items.map(d=>{
        const cls=d.type==='deposit'?'deposit':'withdraw';
        const sign=d.type==='deposit'?'+':'-';
        return `<div class="tx-item">
          <div class="tx-top">${d.date} | ${d.time}</div>
          <div class="tx-row"><div class="tx-name">${d.name}</div><div class="tx-amt ${cls}">${sign}${fmtKR(d.amount)}ì›</div></div>
          <div class="tx-bal">ì”ì•¡ ${fmtKR(d.balance)} ì›</div></div>`;
      }).join('');
    }
    render();

    const mask=document.getElementById('mask'), sheet=document.getElementById('sheet'),
          openFilter=document.getElementById('openFilter'), applyBtn=document.getElementById('applyFilter');
    function openSheet(){mask.style.opacity=1;mask.style.pointerEvents='auto';sheet.style.bottom=0;}
    function closeSheet(){mask.style.opacity=0;mask.style.pointerEvents='none';sheet.style.bottom='-100%';}
    openFilter.addEventListener('click',openSheet); mask.addEventListener('click',closeSheet);
    function selectSingle(id,key){
      const box=document.getElementById(id);
      box.addEventListener('click',e=>{
        const btn=e.target.closest('.opt'); if(!btn)return;
        Array.from(box.querySelectorAll('.opt')).forEach(b=>b.classList.remove('selected'));
        btn.classList.add('selected'); state[key]=btn.dataset[key];
      });
    }
    selectSingle('periodBtns','period'); selectSingle('typeBtns','type'); selectSingle('sortBtns','sort');
    applyBtn.addEventListener('click',()=>{
      state.min=document.getElementById('minAmt').value.trim();
      state.max=document.getElementById('maxAmt').value.trim();
      const p={'1m':'1ê°œì›”','3m':'3ê°œì›”','6m':'6ê°œì›”','1y':'1ë…„'},
            t={'all':'ì „ì²´','withdraw':'ì¶œê¸ˆë§Œ','deposit':'ì…ê¸ˆë§Œ'},
            s={'latest':'ìµœì‹ ìˆœ','oldest':'ê³¼ê±°ìˆœ'};
      document.getElementById('openFilter').textContent=`${p[state.period]}Â·${t[state.type]}Â·${s[state.sort]} âŒ„`;
      render(); closeSheet();
    });

    /* ===== PWA: ê²½ë¡œ ìë™ ì¸ì‹ + SW ë“±ë¡ + ì„¤ì¹˜ í•¸ë“¤ëŸ¬ ===== */
    (function setupPWA(){
      const path = location.pathname;               // /, /Kbank/, /Kbank/index.html ...
      const base = path.endsWith('/') ? path : path.substring(0, path.lastIndexOf('/')+1);
      // manifest ê²½ë¡œ ì•ˆì „ ì„¸íŒ…
      const mf = document.getElementById('manifestLink');
      mf.setAttribute('href', base + 'manifest.json');

      if ('serviceWorker' in navigator) {
        window.addEventListener('load', async () => {
          try{
            const reg = await navigator.serviceWorker.register(base + 'service-worker.js', { scope: base });
            await navigator.serviceWorker.ready; // ì»¨íŠ¸ë¡¤ëœ ë’¤ ì„¤ì¹˜ ë²„íŠ¼ ë…¸ì¶œ
          }catch(e){ console.error('SW register fail', e); }
        });
      }

      let deferredPrompt=null;
      const installBtn=document.getElementById('installBtn');

      window.addEventListener('beforeinstallprompt',(e)=>{
        e.preventDefault();
        deferredPrompt=e;
        installBtn.style.display='block';
      });

      installBtn.addEventListener('click', async ()=>{
        if(!deferredPrompt) return;
        installBtn.disabled=true;
        deferredPrompt.prompt();
        await deferredPrompt.userChoice;
        deferredPrompt=null;
        installBtn.style.display='none';
        installBtn.disabled=false;
      });

      window.addEventListener('appinstalled', ()=>{ installBtn.style.display='none'; });
    })();
  </script>
</body>
</html>
